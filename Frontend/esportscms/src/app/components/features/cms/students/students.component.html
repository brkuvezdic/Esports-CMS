@if (isHidden) {
<div class="container my-5">
  <h3 class="mb-4">Students</h3>

  @if (students.length === 0) {
    <p class="text-muted">No students found.</p>
  }

  @if (students.length > 0) {
    <table class="table table-striped table-hover shadow-sm">
      <thead>
        <tr>
          <th>ID</th>
          <th>Username</th>
          <th>Current Role</th>
          <th>New Role</th>
        </tr>
      </thead>

      <tbody>
        @for (student of students; track student.id) {
        <tr>
          <td>{{ student.id }}</td>
          <td>{{ student.username }}</td>
          <td>{{ student.role }}</td>
          <td>
            <select 
              class="form-select" 
              [(ngModel)]="student.selectedRoleId"
              (ngModelChange)="onRoleChange()">
              <option [ngValue]="null" disabled>
                Select role
              </option>
              
              @for (role of getRolesForStudent(student); track role.id) {
                <option [ngValue]="role.id">
                  {{ role.roleName }}
                </option>
              }
            </select>
          </td>
        </tr>
        }
      </tbody>
    </table>

    <div class="mt-4 d-flex gap-2 justify-content-end">
      <button 
        class="btn btn-secondary" 
        (click)="onUndoChanges()"
        [disabled]="isUpdateButtonDisabled">
        Undo Changes
      </button>
      <button 
        class="btn btn-primary" 
        (click)="updateRoles()"
        [disabled]="isUpdateButtonDisabled">
        Update Roles ({{ getChangedCount() }})
      </button>
    </div>
  }
</div>
}
